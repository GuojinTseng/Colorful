(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7789,        217]
NotebookOptionsPosition[      7203,        201]
NotebookOutlinePosition[      7556,        216]
CellTagsIndexPosition[      7513,        213]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "LAB2LCHab", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<deg\>\"", "\[Rule]", "False"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LAB2LCHab", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"L_", ",", "A_", ",", "B_"}], "}"}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"C", ",", "Ht", ",", "H"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"C", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"{", 
        RowBox[{"A", ",", "B"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ht", "=", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"B", "/", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Ht", "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
        "Ht", ",", 
        RowBox[{"Ht", "+", 
         RowBox[{"2", "Pi"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "\"\<deg\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"L", ",", "C", ",", 
         RowBox[{
          RowBox[{"H", "/", "Pi"}], "*", "180"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"L", ",", "C", ",", "H"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.789947468323057*^9, 3.789947517545578*^9}, {
  3.7899475881476717`*^9, 3.789947659750996*^9}, {3.789947708880411*^9, 
  3.789947932374713*^9}, {3.789947986308619*^9, 3.789948143260878*^9}, {
  3.789948180532037*^9, 3.7899482045615883`*^9}, {3.789948244073124*^9, 
  3.789948244555119*^9}, {3.789948280265287*^9, 3.7899483595873547`*^9}, {
  3.789948493560066*^9, 3.789948600706923*^9}, {3.789948650647843*^9, 
  3.78994865809375*^9}, {3.78994868815799*^9, 3.789948774825232*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"5c83cfa5-2248-4884-9834-d914314296c4"],

Cell[BoxData[
 RowBox[{"LAB2LCHab", "[", 
  RowBox[{"{", 
   RowBox[{"100", ",", "0.5", ",", "0.5"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.789948604273675*^9, 3.789948606870399*^9}, {
  3.789948641970106*^9, 3.789948646516074*^9}, {3.7899487894741173`*^9, 
  3.789948801464624*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"c43fb7cd-1596-491a-b253-87aa644b9d17"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.789948777711419*^9, 3.789948778929858*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"db0e338e-79ef-4b71-a5e6-2abdfccd0bc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DE00XYZ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"X1_", ",", "Y1_", ",", "Z1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"X2_", ",", "Y2_", ",", "Z2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "L1", ",", "L2", ",", "a1", ",", "a2", ",", "b1", ",", "b2", ",", "Lbp", 
      ",", "C1", ",", "C2", ",", "Cb", ",", "G", ",", "a1p", ",", "a2p", ",", 
      "C1p", ",", "C2p", ",", "Cbp", ",", "h1p", ",", "h2p", ",", "Hbp", ",", 
      "T", ",", "dhp", ",", "dLp", ",", "dCp", ",", "dHp", ",", "SL", ",", 
      "SC", ",", "SH", ",", "d\[Theta]", ",", "RC", ",", "RT", ",", "KL", ",",
       "KC", ",", "KH"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"L1", ",", "a1", ",", "a1"}], "}"}], "=", 
      RowBox[{"XYZ2LAB", "[", 
       RowBox[{"{", 
        RowBox[{"X1", ",", "Y1", ",", "Z1"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"L2", ",", "a2", ",", "a2"}], "}"}], "=", 
      RowBox[{"XYZ2LAB", "[", 
       RowBox[{"{", 
        RowBox[{"X2", ",", "Y2", ",", "Z2"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Lbp", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"L1", "+", "L2"}], ")"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"C1", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"{", 
        RowBox[{"a1", ",", "b1"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"C2", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"{", 
        RowBox[{"a2", ",", "b2"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Cb", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"C1", "+", "C2"}], ")"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"G", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"Cb", "^", "7"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cb", "^", "7"}], "+", 
             RowBox[{"25", "^", "7"}]}], ")"}]}], "]"}]}], ")"}], "/", 
       "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1p", "=", 
      RowBox[{"a1", 
       RowBox[{"(", 
        RowBox[{"1", "+", "G"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2p", "=", 
      RowBox[{"a2", 
       RowBox[{"(", 
        RowBox[{"1", "+", "G"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"C1p", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"{", 
        RowBox[{"a1p", ",", "b1"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"C2p", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"{", 
        RowBox[{"a2p", ",", "b2"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Cbp", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"C1p", "+", "C2p"}], ")"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dLp", "/", "KL"}], "/", "SL"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dCp", "/", "KC"}], "/", "SC"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dHp", "/", "KH"}], "/", "SH"}], ")"}], "^", "2"}], "+", 
       RowBox[{"RT", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dCp", "/", "KC"}], "/", "SC"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"dHp", "/", "KH"}], "/", "SH"}], ")"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7899493628664827`*^9, 3.789949435111311*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"5377127c-d5bb-443f-a107-8e4a73634720"]
},
WindowSize->{1133, 624},
WindowMargins->{{Automatic, -426}, {Automatic, -953}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (2019\:5e744\:67088\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2138, 52, 397, "Input",ExpressionUUID->"5c83cfa5-2248-4884-9834-d914314296c4"],
Cell[2699, 74, 374, 8, 30, "Input",ExpressionUUID->"c43fb7cd-1596-491a-b253-87aa644b9d17"],
Cell[3076, 84, 175, 3, 30, "Input",ExpressionUUID->"db0e338e-79ef-4b71-a5e6-2abdfccd0bc2"],
Cell[3254, 89, 3945, 110, 535, "Input",ExpressionUUID->"5377127c-d5bb-443f-a107-8e4a73634720"]
}
]
*)

